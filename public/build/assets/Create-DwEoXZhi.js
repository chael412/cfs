import{a as i,b as k,j as a,M as T,r as s,U as I,c as M}from"./app-XEDclc3Q.js";import{A as $,B as R}from"./AuthenticatedLayout-B3x5-IK0.js";import{S as b}from"./react-select.esm-Df2lUb-A.js";const U=({customers:g,collectors:z,generated_bill_no:c})=>{const[E,x]=i.useState(""),[v,t]=i.useState(""),[j,y]=i.useState(""),[N,f]=i.useState(""),{data:r,setData:l,post:_,errors:n,reset:C,processing:w}=k({customer_plan_id:"",bill_no:c,rebate:"",partial:"",bill_amount:"",remarks:""}),P=async e=>{e.preventDefault(),console.log(r),await _(route("walkin_bills.store"),{onSuccess:()=>{alert("Walkin Bill was created successfully!"),C()},onError:o=>{console.log(o)}})},m=g.map(e=>({value:e.id,label:`${e.lastname} ${e.firstname}`})),S=async e=>{if(console.log("Selected Option: ",e.value),e){l("customer_id",e.value);try{const o=await M.get(`/api/customers/${e.value}/latest-plan`);if(o.data){const{id:u,mbps:p,plan_price:h,registration_date:B}=o.data;console.log("Latest Plan Mbps: ",p),console.log("Plan Price: ",h),l("customer_plan_id",u),x(u),t(p),y(h),f(B)}else console.log("No plan found for the selected customer."),t("No Mbps plan available")}catch(o){console.error("Error fetching the plan:",o),t("Error fetching Mbps plan")}}else t("")},d=[{value:"paid",label:"Paid"},{value:"unpaid",label:"Unpaid"}];return console.log("trish"+c),a.jsxs($,{children:[a.jsx(T,{title:"Create New Bill"}),a.jsx("div",{className:"bg-white overflow-y-auto max-h-[590px] grid place-justify-center ",children:a.jsx("div",{className:"mt-2 px-4",children:a.jsx("div",{className:"mb-6 flex justify-between items-center",children:a.jsxs(s.Card,{color:"white",className:" mx-auto w-full max-w-xl  p-8 shadow-md rounded-md mt-1 mb-2",children:[a.jsx("div",{className:"flex justify-end mb-2",children:a.jsx(s.Tooltip,{content:"Back",children:a.jsx(I,{href:"/walkin_bills",className:"hover:bg-gray-200 px-2 py-1 rounded",children:a.jsx(R,{className:"text-xl cursor-pointer"})})})}),a.jsx(s.Typography,{variant:"h5",color:"blue-gray",className:"text-center",children:"New Bill"}),a.jsxs("form",{onSubmit:P,className:"mt-8 mb-2",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.jsxs("div",{className:"mb-3",children:[a.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Bill No."}),a.jsx("input",{type:"hidden",value:r.customer_plan_id,onChange:e=>l("customer_plan_id",e.target.value)}),a.jsx("input",{type:"hidden",value:r.bill_no,onChange:e=>l("bill_no",e.target.value)}),a.jsx(s.Input,{size:"md",value:r.bill_no,disabled:!0})]})}),a.jsxs("div",{className:"mb-3",children:[a.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Customers"}),a.jsx(b,{options:m,placeholder:"Choose a customer",isSearchable:!0,value:m.find(e=>e.value===r.customer_id),onChange:S,className:`${n.customer_id?"border border-red-600":""}`})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Mbps Plan"}),a.jsx(s.Input,{disabled:!0,size:"md",value:`${v} mbps - â‚±${new Intl.NumberFormat("en-PH").format(j)}`,onChange:e=>t(e.target.value)})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Date Registration"}),a.jsx(s.Input,{disabled:!0,type:"date",size:"md",value:N,onChange:e=>t(e.target.value)})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Rebate"}),a.jsx(s.Input,{type:"number",size:"md",value:r.rebate,onChange:e=>l("rebate",e.target.value),error:!!n.rebate})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Partial"}),a.jsx(s.Input,{type:"number",size:"md",value:r.partial,onChange:e=>l("partial",e.target.value),error:!!n.partial})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Amount"}),a.jsx(s.Input,{type:"number",size:"md",value:r.bill_amount,onChange:e=>l("bill_amount",e.target.value),error:!!n.bill_amount})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Remark"}),a.jsx(b,{options:d,placeholder:"Choose a remark",isClearable:!0,value:d.find(e=>e.value===r.remarks),onChange:e=>l("remarks",e?e.value:"")})]}),a.jsx(s.Button,{type:"submit",disabled:w,className:"mt-6 w-full",color:"blue",fullWidth:!0,children:"Save"})]})]})})})})]})};export{U as default};
