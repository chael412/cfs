import{a as i,b as _,j as a,M as f,r as t}from"./app-2YHvFdgv.js";import{S as T}from"./react-select.esm-UiqQEPvp.js";import{A as P}from"./AuthenticatedLayout-BD_EVhex.js";const C=({transaction:s,collectors:S,latest:E})=>{const[A,p]=i.useState(""),[c,m]=i.useState(s.partial??0),[b,h]=i.useState(0),[g,x]=i.useState(0),{data:r,setData:n,patch:N,errors:w,reset:v,processing:z}=_({id:s.id,customer_id:s.customer_plan.customer.id,customer_plan_id:s.customer_plan_id,bill_no:s.bill_no,rebate:s.rebate,partial:s.partial,bill_amount:s.bill_amount,remarks:s.remarks,status:s.status}),d=[{value:"paid",label:"Paid"},{value:"unpaid",label:"Unpaid"}];i.useEffect(()=>{const e=Number(s.customer_plan.plan.plan_price)||0,l=Number(r.rebate||0),o=Number(c||0),u=e-l;h(u);const j=u-o;x(j),n("bill_amount",u)},[r.rebate,c,s.customer_plan.plan.plan_price]);const y=async e=>{e.preventDefault(),console.log("Form Data:",JSON.stringify(r,null,2)),await N(route("transactions.update",r.id),{onSuccess:()=>{alert("Transaction updated successfully!"),window.location.reload(),v()},onError:l=>{console.log(l)}})};return a.jsxs(P,{children:[a.jsx(f,{title:"Billing Transactions"}),a.jsx("div",{className:"flex justify-center ",children:a.jsx("div",{className:"mb-10 w-full lg:w-[35%] p-4 overflow-auto shadow-md rounded-md border-2 border-sky-500 ",children:a.jsxs("form",{onSubmit:y,children:[a.jsx("input",{type:"hidden",className:"mb-2"}),a.jsxs("div",{className:"mb-1",children:[a.jsx(t.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Acc No."}),a.jsx(t.Input,{size:"md",value:r.customer_id,disabled:!0,className:"mb-3"})]}),a.jsxs("div",{className:"mb-1",children:[a.jsx(t.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Bill No."}),a.jsx(t.Input,{size:"md",value:r.bill_no,disabled:!0,className:"mb-3"})]}),a.jsxs("div",{className:"mb-1",children:[a.jsx(t.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Rebate"}),a.jsx(t.Input,{type:"number",size:"md",value:r.rebate??0,onChange:e=>{const l=Number(e.target.value),o=Number(s.customer_plan.plan.plan_price);l>o?(alert(`Rebate cannot be greater than Plan Price (${o}).`),n("rebate",o)):n("rebate",l),p(l)},className:"mb-3",onWheel:e=>e.target.blur()})]}),a.jsxs("div",{className:"mb-1",children:[a.jsx(t.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Partial"}),a.jsx(t.Input,{type:"number",size:"md",value:r.partial??0,onChange:e=>{const l=Number(e.target.value),o=Number(s.customer_plan.plan.plan_price)-Number(r.rebate||0);l>o?(alert(`Partial cannot be greater than Total Amount Paid (${o}).`),n("partial",o),m(o)):(n("partial",l),m(l))},className:"mb-3",onWheel:e=>e.target.blur()})]}),a.jsxs("div",{className:"mb-1",children:[a.jsx(t.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Total Amount Paid"}),a.jsx(t.Input,{type:"number",size:"md",value:b,className:"mb-3",disabled:!0})]}),a.jsxs("div",{className:"mb-1",children:[a.jsx(t.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Outstanding Balance"}),a.jsx(t.Input,{size:"md",value:g,disabled:!0,className:"mb-3"})]}),a.jsxs("div",{className:"mb-1",children:[a.jsx(t.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Status"}),a.jsx(T,{options:d,placeholder:"Choose a status",value:d.find(e=>e.value===r.status),onChange:e=>n("status",e?e.value:""),className:"mb-3"})]}),a.jsx(t.Button,{type:"submit",color:"blue",fullWidth:!0,children:"Update"})]})})})]})};export{C as default};
