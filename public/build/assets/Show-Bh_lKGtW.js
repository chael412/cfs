import{b,V as j,a as u,j as e,M as f,r,U as N,E as v}from"./app-Ba6RNGlm.js";import{a as _}from"./index-0UCH77rR.js";import{A as w,B as C,M as T}from"./AuthenticatedLayout-C4MSxFMt.js";import{S}from"./react-select.esm-D-YEDZgg.js";import{f as E}from"./format-BzRktsyD.js";const H=({latestPlan:l,plans:d})=>{var i;const{data:n,setData:x,patch:p,errors:m,reset:P,processing:h}=b({customer_plan_id:l.id||"",customer_id:l.customer_id||"",plan_id:l.plan_id||""}),{customer:s}=j().props,[o,y]=u.useState(!1),t=()=>y(!o),c=d.map(a=>({value:a.id,label:`${a.mbps} mbps - ${new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(a.plan_price)}`})),g=()=>{p(route("customer_plans.update",n.customer_plan_id),{preserveScroll:!0,onSuccess:()=>{alert("Customer plan updated successfully!"),t()},onError:a=>{console.error(a)}})};return e.jsxs(w,{children:[e.jsx(f,{title:"Collector Profile"}),e.jsx("div",{className:"bg-white overflow-y-auto max-h-[550px]",children:e.jsxs("div",{className:"mt-5 px-4 ",children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center ",children:[e.jsxs("div",{children:[e.jsxs(r.Typography,{variant:"lead",size:"small",className:"mb-0 text-lg font-bold border-b border-b-gray-700",children:[s.firstname," ",s.middlename??"",s.lastname," Plans"]}),e.jsx(r.Typography,{className:"text-sm",variant:"paragraph",size:"small",children:"All plans"})]}),e.jsx(r.Tooltip,{content:"Back",children:e.jsx(N,{href:"/customer_plans",className:"hover:bg-gray-200 px-2 py-1 rounded mr-4",children:e.jsx(C,{className:"text-xl cursor-pointer"})})})]}),e.jsxs("div",{className:"grid grid-cols-40/60 ",children:[e.jsx("div",{className:"flex flex-col justify-between items-center",children:e.jsxs(r.Card,{color:"white",className:" h-60 flex-2 justify-center gap-4 items-center py-2 px-8 shadow-sm rounded-md mt-1 mb-0 mr-2 w-72 border-2 border-gray-100",children:[e.jsx("div",{children:e.jsx(r.Tooltip,{content:"Edit",children:e.jsx(r.Button,{variant:"text",onClick:t,children:e.jsx(_,{className:"text-blue-700 text-xl"})})})}),e.jsx(T,{className:"text-4xl text-green-700"}),e.jsxs("div",{className:"flex flex-col justify-center gap-1",children:[e.jsx(r.Typography,{variant:"h5",children:"Current Plan"}),e.jsx("div",{className:"bg-green-100",children:e.jsxs(r.Typography,{variant:"paragraph",className:"text-center",children:[l.plan.mbps," mbps"]})})]})]})}),e.jsx("div",{className:"p-4 overflow-x-auto",children:e.jsx("div",{className:"",children:e.jsxs("table",{className:"w-full text-left border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"px-6 py-3 text-sm font-semibold bg-gray-300 text-gray-700 uppercase border border-gray-400",children:e.jsx(r.Typography,{variant:"small",color:"blue-gray",className:"text-[12px] font-normal leading-none opacity-70",children:"Mbps"})}),e.jsx("th",{className:"px-6 py-3 text-sm font-semibold bg-gray-300 text-gray-700 uppercase border border-gray-400",children:e.jsx(r.Typography,{variant:"small",color:"blue-gray",className:"text-[12px] font-normal leading-none opacity-70",children:"Price Plan"})}),e.jsx("th",{className:"w-[15%] px-6 py-3 text-sm font-semibold bg-gray-300 text-gray-700 uppercase border border-gray-400",children:e.jsx(r.Typography,{variant:"small",color:"blue-gray",className:"text-[12px] font-normal leading-none opacity-70 text-nowrap",children:"Date Registration"})})]})}),e.jsx("tbody",{children:e.jsx(v,{data:["customer"],fallback:e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"border border-blue-gray-100 p-4",children:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(r.Spinner,{className:"h-8 w-8",color:"green"})})})}),children:((i=s==null?void 0:s.customer_plans)==null?void 0:i.length)>0?s.customer_plans.map(a=>e.jsxs("tr",{className:"hover:bg-blue-gray-50",children:[e.jsx("td",{className:"border border-blue-gray-100 px-4 py-2",children:e.jsxs(r.Typography,{variant:"small",className:"font-normal text-gray-800 text-[13px]",children:[a.plan.mbps," Mbps"]})}),e.jsx("td",{className:"border border-blue-gray-100 px-4",children:e.jsx(r.Typography,{variant:"small",className:"font-normal text-gray-800 text-[13px]",children:Number(a.plan.plan_price).toLocaleString("en-PH",{style:"currency",currency:"PHP"})})}),e.jsx("td",{className:"border border-blue-gray-100 px-4",children:e.jsx(r.Typography,{variant:"small",className:"font-normal text-gray-800 text-[13px]",children:E(new Date(a.plan.created_at),"M/d/yyyy")})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center text-gray-500",children:"No Customer plans found."})})})})]})})})]})]})}),e.jsxs(r.Dialog,{open:o,handler:t,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Edit Plan"}),e.jsx(r.DialogBody,{children:e.jsx(S,{options:c,placeholder:"Choose a plan",isClearable:!0,value:c.find(a=>a.value===n.plan_id),onChange:a=>x("plan_id",a?a.value:""),className:`${m.plan_id?"border border-red-600":""}`})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:t,className:"mr-1",children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",onClick:g,disabled:h,children:e.jsx("span",{children:"Update"})})]})]})]})};export{H as default};
