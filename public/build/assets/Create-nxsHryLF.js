import{b as c,a as $,j as e,M as P,r as s,U as B,c as T}from"./app-BYVCUyL5.js";import{A as M,B as E}from"./AuthenticatedLayout-CDwpBVZZ.js";import{S as h}from"./react-select.esm-DDZYVUdh.js";const D=({customers:g,collectors:b})=>{const[i,r]=c.useState(""),[x,v]=c.useState(""),[j,y]=c.useState(""),{data:o,setData:t,post:N,errors:n,reset:f,processing:C}=$({customer_id:"",bill_no:"",or_no:"",amount:"",remarks:"",collector_id:""});console.log(i);const _=async a=>{a.preventDefault(),await N(route("customers.store"),{onSuccess:()=>{alert("Customer was added successfully!"),f()},onError:l=>{console.log(l)}})},m=Object.values(g).map(a=>({value:a.customer.id,label:`${a.customer.lastname} ${a.customer.firstname}`})),d=b.map(a=>({value:a.id,label:`${a.lastname} ${a.firstname}`})),w=async a=>{if(console.log("Selected Option: ",a.value),a){t("customer_id",a.value);try{const l=await T.get(`/api/customers/${a.value}/latest-plan`);if(l.data){const{mbps:u,plan_price:p,registration_date:S}=l.data;console.log("Latest Plan Mbps: ",u),console.log("Plan Price: ",p),r(u),v(p),y(S)}else console.log("No plan found for the selected customer."),r("No Mbps plan available")}catch(l){console.error("Error fetching the plan:",l),r("Error fetching Mbps plan")}}else r("")};return e.jsxs(M,{children:[e.jsx(P,{title:"Add Customer"}),e.jsx("div",{className:"bg-white overflow-y-auto max-h-[590px] grid place-justify-center ",children:e.jsx("div",{className:"mt-2 px-4",children:e.jsx("div",{className:"mb-6 flex justify-between items-center",children:e.jsxs(s.Card,{color:"white",className:" mx-auto w-full max-w-xl  p-8 shadow-md rounded-md mt-1 mb-2",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsx(s.Tooltip,{content:"Back",children:e.jsx(B,{href:"/bills",className:"hover:bg-gray-200 px-2 py-1 rounded",children:e.jsx(E,{className:"text-xl cursor-pointer"})})})}),e.jsx(s.Typography,{variant:"h5",color:"blue-gray",className:"text-center",children:"New Bill"}),e.jsxs("form",{onSubmit:_,className:"mt-8 mb-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Bill No."}),e.jsx(s.Input,{size:"md",value:o.bill_no,onChange:a=>t("bill_no",a.target.value),error:!!n.bill_no,className:"w-full"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Or No."}),e.jsx(s.Input,{size:"md",value:o.or_no,onChange:a=>t("or_no",a.target.value),error:!!n.or_no})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Customers"}),e.jsx(h,{options:m,placeholder:"Choose a customer",isSearchable:!0,value:m.find(a=>a.value===o.customer_id),onChange:w,className:`${n.customer_id?"border border-red-600":""}`})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Mbps Plan"}),e.jsx(s.Input,{disabled:!0,size:"md",value:`${i} mbps - â‚±${new Intl.NumberFormat("en-PH").format(x)}`,onChange:a=>r(a.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Date Registration"}),e.jsx(s.Input,{disabled:!0,type:"date",size:"md",value:j,onChange:a=>r(a.target.value)})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Amount"}),e.jsx(s.Input,{type:"number",size:"md",value:o.amount,onChange:a=>t("amount",a.target.value),error:!!n.amount})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Collectors"}),e.jsx(h,{options:d,placeholder:"Choose a collector",isClearable:!0,value:d.find(a=>a.value===o.collector_id),onChange:a=>t("collector_id",a?a.value:""),className:`${n.collector_id?"border border-red-600":""}`})]}),e.jsx(s.Button,{type:"submit",disabled:C,className:"mt-6 w-full",color:"blue",fullWidth:!0,children:"Save"})]})]})})})})]})};export{D as default};
