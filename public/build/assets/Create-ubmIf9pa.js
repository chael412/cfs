import{g as le,a as _,V as se,b as oe,j as e,M as ce,r as u,U as de,c as X}from"./app-DLh5A8qO.js";import{A as ue,B as he}from"./AuthenticatedLayout-C_4TbmOA.js";import{S as me}from"./react-select.esm-CbUvYbr4.js";import{U as pe}from"./UseAppUrl-CnXU_rnl.js";import{u as ne}from"./useQuery-C25iiuVX.js";var Z={exports:{}},be=Z.exports,ie;function fe(){return ie||(ie=1,function(ee,ae){(function(L,$){ee.exports=$()})(be,function(){var L=1e3,$=6e4,J=36e5,p="millisecond",A="second",T="minute",P="hour",S="day",U="week",N="month",V="quarter",C="year",O="date",G="Invalid Date",F=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,te=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,q={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(l){var r=["th","st","nd","rd"],a=l%100;return"["+l+(r[(a-20)%10]||r[a]||r[0])+"]"}},R=function(l,r,a){var n=String(l);return!n||n.length>=r?l:""+Array(r+1-n.length).join(a)+l},re={s:R,z:function(l){var r=-l.utcOffset(),a=Math.abs(r),n=Math.floor(a/60),s=a%60;return(r<=0?"+":"-")+R(n,2,"0")+":"+R(s,2,"0")},m:function l(r,a){if(r.date()<a.date())return-l(a,r);var n=12*(a.year()-r.year())+(a.month()-r.month()),s=r.clone().add(n,N),c=a-s<0,d=r.clone().add(n+(c?-1:1),N);return+(-(n+(a-s)/(c?s-d:d-s))||0)},a:function(l){return l<0?Math.ceil(l)||0:Math.floor(l)},p:function(l){return{M:N,y:C,w:U,d:S,D:O,h:P,m:T,s:A,ms:p,Q:V}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(l){return l===void 0}},I="en",B={};B[I]=q;var W="$isDayjsObject",Q=function(l){return l instanceof E||!(!l||!l[W])},Y=function l(r,a,n){var s;if(!r)return I;if(typeof r=="string"){var c=r.toLowerCase();B[c]&&(s=c),a&&(B[c]=a,s=c);var d=r.split("-");if(!s&&d.length>1)return l(d[0])}else{var m=r.name;B[m]=r,s=m}return!n&&s&&(I=s),s||!n&&I},f=function(l,r){if(Q(l))return l.clone();var a=typeof r=="object"?r:{};return a.date=l,a.args=arguments,new E(a)},h=re;h.l=Y,h.i=Q,h.w=function(l,r){return f(l,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var E=function(){function l(a){this.$L=Y(a.locale,null,!0),this.parse(a),this.$x=this.$x||a.x||{},this[W]=!0}var r=l.prototype;return r.parse=function(a){this.$d=function(n){var s=n.date,c=n.utc;if(s===null)return new Date(NaN);if(h.u(s))return new Date;if(s instanceof Date)return new Date(s);if(typeof s=="string"&&!/Z$/i.test(s)){var d=s.match(F);if(d){var m=d[2]-1||0,b=(d[7]||"0").substring(0,3);return c?new Date(Date.UTC(d[1],m,d[3]||1,d[4]||0,d[5]||0,d[6]||0,b)):new Date(d[1],m,d[3]||1,d[4]||0,d[5]||0,d[6]||0,b)}}return new Date(s)}(a),this.init()},r.init=function(){var a=this.$d;this.$y=a.getFullYear(),this.$M=a.getMonth(),this.$D=a.getDate(),this.$W=a.getDay(),this.$H=a.getHours(),this.$m=a.getMinutes(),this.$s=a.getSeconds(),this.$ms=a.getMilliseconds()},r.$utils=function(){return h},r.isValid=function(){return this.$d.toString()!==G},r.isSame=function(a,n){var s=f(a);return this.startOf(n)<=s&&s<=this.endOf(n)},r.isAfter=function(a,n){return f(a)<this.startOf(n)},r.isBefore=function(a,n){return this.endOf(n)<f(a)},r.$g=function(a,n,s){return h.u(a)?this[n]:this.set(s,a)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(a,n){var s=this,c=!!h.u(n)||n,d=h.p(a),m=function(M,t){var i=h.w(s.$u?Date.UTC(s.$y,t,M):new Date(s.$y,t,M),s);return c?i:i.endOf(S)},b=function(M,t){return h.w(s.toDate()[M].apply(s.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),s)},x=this.$W,y=this.$M,v=this.$D,k="set"+(this.$u?"UTC":"");switch(d){case C:return c?m(1,0):m(31,11);case N:return c?m(1,y):m(0,y+1);case U:var w=this.$locale().weekStart||0,H=(x<w?x+7:x)-w;return m(c?v-H:v+(6-H),y);case S:case O:return b(k+"Hours",0);case P:return b(k+"Minutes",1);case T:return b(k+"Seconds",2);case A:return b(k+"Milliseconds",3);default:return this.clone()}},r.endOf=function(a){return this.startOf(a,!1)},r.$set=function(a,n){var s,c=h.p(a),d="set"+(this.$u?"UTC":""),m=(s={},s[S]=d+"Date",s[O]=d+"Date",s[N]=d+"Month",s[C]=d+"FullYear",s[P]=d+"Hours",s[T]=d+"Minutes",s[A]=d+"Seconds",s[p]=d+"Milliseconds",s)[c],b=c===S?this.$D+(n-this.$W):n;if(c===N||c===C){var x=this.clone().set(O,1);x.$d[m](b),x.init(),this.$d=x.set(O,Math.min(this.$D,x.daysInMonth())).$d}else m&&this.$d[m](b);return this.init(),this},r.set=function(a,n){return this.clone().$set(a,n)},r.get=function(a){return this[h.p(a)]()},r.add=function(a,n){var s,c=this;a=Number(a);var d=h.p(n),m=function(y){var v=f(c);return h.w(v.date(v.date()+Math.round(y*a)),c)};if(d===N)return this.set(N,this.$M+a);if(d===C)return this.set(C,this.$y+a);if(d===S)return m(1);if(d===U)return m(7);var b=(s={},s[T]=$,s[P]=J,s[A]=L,s)[d]||1,x=this.$d.getTime()+a*b;return h.w(x,this)},r.subtract=function(a,n){return this.add(-1*a,n)},r.format=function(a){var n=this,s=this.$locale();if(!this.isValid())return s.invalidDate||G;var c=a||"YYYY-MM-DDTHH:mm:ssZ",d=h.z(this),m=this.$H,b=this.$m,x=this.$M,y=s.weekdays,v=s.months,k=s.meridiem,w=function(t,i,o,j){return t&&(t[i]||t(n,c))||o[i].slice(0,j)},H=function(t){return h.s(m%12||12,t,"0")},M=k||function(t,i,o){var j=t<12?"AM":"PM";return o?j.toLowerCase():j};return c.replace(te,function(t,i){return i||function(o){switch(o){case"YY":return String(n.$y).slice(-2);case"YYYY":return h.s(n.$y,4,"0");case"M":return x+1;case"MM":return h.s(x+1,2,"0");case"MMM":return w(s.monthsShort,x,v,3);case"MMMM":return w(v,x);case"D":return n.$D;case"DD":return h.s(n.$D,2,"0");case"d":return String(n.$W);case"dd":return w(s.weekdaysMin,n.$W,y,2);case"ddd":return w(s.weekdaysShort,n.$W,y,3);case"dddd":return y[n.$W];case"H":return String(m);case"HH":return h.s(m,2,"0");case"h":return H(1);case"hh":return H(2);case"a":return M(m,b,!0);case"A":return M(m,b,!1);case"m":return String(b);case"mm":return h.s(b,2,"0");case"s":return String(n.$s);case"ss":return h.s(n.$s,2,"0");case"SSS":return h.s(n.$ms,3,"0");case"Z":return d}return null}(t)||d.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(a,n,s){var c,d=this,m=h.p(n),b=f(a),x=(b.utcOffset()-this.utcOffset())*$,y=this-b,v=function(){return h.m(d,b)};switch(m){case C:c=v()/12;break;case N:c=v();break;case V:c=v()/3;break;case U:c=(y-x)/6048e5;break;case S:c=(y-x)/864e5;break;case P:c=y/J;break;case T:c=y/$;break;case A:c=y/L;break;default:c=y}return s?c:h.a(c)},r.daysInMonth=function(){return this.endOf(N).$D},r.$locale=function(){return B[this.$L]},r.locale=function(a,n){if(!a)return this.$L;var s=this.clone(),c=Y(a,n,!0);return c&&(s.$L=c),s},r.clone=function(){return h.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},l}(),z=E.prototype;return f.prototype=z,[["$ms",p],["$s",A],["$m",T],["$H",P],["$W",S],["$M",N],["$y",C],["$D",O]].forEach(function(l){z[l[1]]=function(r){return this.$g(r,l[0],l[1])}}),f.extend=function(l,r){return l.$i||(l(r,E,f),l.$i=!0),f},f.locale=Y,f.isDayjs=Q,f.unix=function(l){return f(1e3*l)},f.en=B[I],f.Ls=B,f.p={},f})}(Z)),Z.exports}var xe=fe();const ge=le(xe),$e=({collectors:ee,generated_bill_no:ae})=>{const L=pe(),[$,J]=_.useState(null),[p,A]=_.useState({}),[T,P]=_.useState(""),S=async({queryKey:t})=>{const[i,o,j,D,g]=t;return(await X.get(`${L}/api/customers/transactions`,{params:{page:o,search:j,sortColumn:D,sortDirection:g}})).data},U=async({queryKey:t})=>{const[i,o,j,D,g]=t;return g?(await X.get(`${L}/api/customers/transactions`,{params:{page:o,search:g,sortColumn:j,sortDirection:D}})).data:{data:[],current_page:1}},{customers:N}=se().props,[V,C]=_.useState(""),[O,G]=_.useState((N==null?void 0:N.current_page)||1),[F,te]=_.useState({column:"",direction:"asc"}),{customer_transactions:q}=se().props;_.useState(""),_.useState((q==null?void 0:q.current_page)||1),_.useState({column:"",direction:"asc"});const{data:R,error:re,isLoading:I,refetch:B}=ne({queryKey:["customers",O,V,F.column,F.direction],queryFn:S,keepPreviousData:!0}),{data:W,isTransLoading:Q,refetch:Y}=ne({queryKey:["customer-transactions",O,F.column,F.direction,$],queryFn:U,enabled:!!$,keepPreviousData:!0}),[f,h]=_.useState(!1),E=()=>h(!f),[z,l]=_.useState(!1),r=()=>{l(!z)},{data:a,setData:n,post:s,errors:c,reset:d,processing:m}=oe({customer_plan_id:"",bill_no:ae,rebate:"",partial:"",bill_amount:"",remarks:"",status:""}),b=async t=>{var j,D;if(t.preventDefault(),!a.customer_plan_id||Number(a.customer_plan_id)<=0){alert("Please select a customer.");return}if(!((j=a.remarks)!=null&&j.trim())){alert("Choose a billing type.");return}if(!a.partial||Number(a.partial)<=0){alert("Partial payment is required");return}if(!((D=a.status)!=null&&D.trim())){alert("Status is required.");return}const i=Number((p==null?void 0:p.plan_price)||0)-Number(a.rebate||0),o={...a,bill_amount:i,rebate:Number(a.rebate)||0,partial:Number(a.partial)||0};try{console.log("Form data to submit:",JSON.stringify(o,null,2));const g=await X.post(`${L}/api/transactions`,o);console.log("Response:",g.data),l(!0),n("bill_amount",""),Y()}catch(g){console.error("Error creating transaction:",g.response||g),alert("Failed to create transaction. Check console for details.")}},x=["Month","Bill Noww.","Bill Amount","Status"],y=["Acc No.","Customer Name","Status"],v=[{value:"paid",label:"Paid"},{value:"unpaid",label:"Unpaid"}],k=(R==null?void 0:R.data.map(t=>({id:t.id,customer_name:`${t.lastname} ${t.firstname} ${t.middlename??""}`,firstname:t.firstname,middlename:t.middlename,lastname:t.lastname,address:t.address,contact_no:t.contact_no,sex:t.sex,marital_status:t.marital_status,birthdate:t.birthdate,occupation:t.occupation,status:t.status,plans:t.customer_plans.map(i=>{const o=i.transactions.length?[...i.transactions].sort((g,K)=>new Date(K.created_at)-new Date(g.created_at))[0]:null;let j=null,D=null;return o&&(j=Number(o.bill_amount)-Number(o.partial),D=ge(o.created_at).format("MMMM")),{customer_plan_id:i.id,mbps:i.plan.mbps,plan_price:i.plan.plan_price,date_registration:i.date_registration,transactions:i.transactions.map(g=>({id:g.id,bill_no:g.bill_no,rebate:g.rebate,partial:g.partial,bill_amount:g.bill_amount,remarks:g.remarks,status:g.status,created_at:g.created_at})),last_transaction:o,balance:j,balanceMonth:D}})})))||[],w=(W==null?void 0:W.data.map(t=>({id:t.id,customer_name:`${t.lastname} ${t.firstname} ${t.middlename??""}`,firstname:t.firstname,middlename:t.middlename,lastname:t.lastname,address:t.address,contact_no:t.contact_no,sex:t.sex,marital_status:t.marital_status,birthdate:t.birthdate,occupation:t.occupation,status:t.status,plans:t.customer_plans.map(i=>({customer_plan_id:i.id,mbps:i.plan.mbps,plan_price:i.plan.plan_price,date_registration:i.date_registration,transactions:i.transactions.map(o=>({id:o.id,bill_no:o.bill_no,rebate:Number(o.rebate)||0,partial:Number(o.partial)||0,bill_amount:Number(o.bill_amount)||0,remarks:o.remarks,status:o.status,created_at:o.created_at,updated_at:o.updated_at}))}))})))||[];_.useEffect(()=>{$!==null&&alert(`Selected Customer: ${p.customer_name}`)},[$,p]);const H=t=>{const i=t.plans[0]||{};J(t.id),n("customer_plan_id",i.customer_plan_id),A({customer_name:`${t.firstname} ${t.lastname}`,customer_plan_id:i.customer_plan_id,mbps:i.mbps||"N/A",plan_price:i.plan_price||"N/A",date_registration:i.date_registration||"N/A",latest_balance:i.latest_balance||0,latest_balance_month:i.latest_balance_month||0}),h(!1)},M=t=>{const i=t.target.value;P(i),n("remarks",i)};return e.jsxs(ue,{children:[e.jsx(ce,{title:"Create New Bill"}),e.jsxs("div",{className:"bg-white overflow-y-auto max-h-[590px] grid place-justify-center ",children:[e.jsxs("div",{className:"flex justify-between mt-5 mb-2 px-4",children:[e.jsxs("div",{className:"flex gap-10",children:[e.jsx(u.Radio,{name:"type",label:"Advance Billing",value:"advance",checked:T==="advance",onChange:M}),e.jsx(u.Radio,{name:"type",label:"Batch Billing",value:"batch",checked:T==="batch",onChange:M})]}),e.jsx(u.Tooltip,{content:"Back",children:e.jsx(de,{href:"/batch_bills",className:"hover:bg-gray-200 px-2 py-1 rounded",children:e.jsx(he,{className:"text-xl cursor-pointer"})})})]}),e.jsxs(u.Dialog,{open:z,handler:r,size:"lg",children:[e.jsx(u.DialogHeader,{children:"Billing Notice"}),e.jsx(u.DialogBody,{children:e.jsxs("div",{className:"relative bg-gray-100 p-6 rounded shadow h-[480px] overflow-auto",children:[e.jsx("div",{className:`absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 rotate-[-30deg]
                text-green-800 font-bold text-6xl border-2 border-green-800
  px-8 py-4 opacity-40 select-none pointer-events-none
                whitespace-nowrap inline-block`,children:"CFS NOTICE PAID"}),e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("img",{src:"/img/internet.png",alt:"CFS Logo",className:"w-16 h-16"}),e.jsxs("div",{className:"text-sm mt-1",children:["#2, Manguelod Bldg. National High Way",e.jsx("br",{}),"District II, Tumauini, Isabela",e.jsx("br",{}),"TIN: 295-973-965-001",e.jsx("br",{}),"CP#: 09453367030"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold",children:"Wesly Ivan Gaffud"}),e.jsx("p",{children:"August 1, 2025"})]})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"Acct. No:"}),e.jsx("span",{children:"1258"})]}),e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("span",{children:"Bill No."}),e.jsx("span",{children:"2510000"})]}),e.jsxs("div",{className:"space-y-1 mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Bill for the month of August"}),e.jsx("span",{children:"₱800.00"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Rebate"}),e.jsx("span",{children:"₱0.00"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Partial"}),e.jsx("span",{children:"₱0.00"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Outstanding Balance Previous Month"}),e.jsx("span",{children:"₱300.00"})]}),e.jsxs("div",{className:"flex justify-between font-bold border-t border-gray-400 pt-2",children:[e.jsx("span",{children:"Amount Due:"}),e.jsx("span",{children:"₱1,100.00"})]})]}),e.jsxs("div",{className:"flex justify-between text-sm mb-4",children:[e.jsx("span",{children:"Prepared by: John"}),e.jsx("span",{children:"Collector: John Robert Linerto"}),e.jsx("span",{children:"Date:"})]}),e.jsxs("div",{className:"border border-red-500 p-3 rounded text-sm bg-red-50 flex items-start gap-2",children:[e.jsx("div",{className:"text-red-600 font-bold",children:"⚠"}),e.jsxs("div",{children:[e.jsx("p",{children:"7 Days Notice: To avoid temporary disconnection kindly settle your bill within 7 days of the due date. For assistance or to make a payment please call:"}),e.jsx("p",{className:"font-bold",children:"CUSTOMER SERVICE NO: 09453367030"}),e.jsx("p",{className:"font-bold",children:"BILLING DEPT. CP NO: 09162832206"})]})]})]})}),e.jsxs(u.DialogFooter,{children:[e.jsx(u.Button,{variant:"text",color:"red",onClick:r,className:"mr-2",children:"Cancel"}),e.jsx(u.Button,{variant:"gradient",color:"green",onClick:r,children:"Print"})]})]}),e.jsxs("div",{className:"flex justify-between items-center px-4",children:[e.jsxs("div",{className:"flex gap-6 px-4",children:[e.jsxs(u.Typography,{variant:"h6",color:"blue-gray",children:["ACC NO.:"," ",e.jsx("span",{className:"text-orange-900",children:$})]}),e.jsxs(u.Typography,{variant:"h6",color:"blue-gray",children:["CUSTOMER:"," ",e.jsx("span",{className:"text-orange-900",children:(p==null?void 0:p.customer_name)||""})]}),e.jsxs(u.Typography,{variant:"h6",color:"blue-gray",children:["PLAN:"," ",e.jsx("span",{className:"text-orange-900",children:p&&p.mbps?`${p.mbps} mbps - ${new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(p.plan_price)}`:""})]}),e.jsxs(u.Typography,{variant:"h6",color:"blue-gray",children:["REGISTRATION:"," ",e.jsx("span",{className:"text-orange-900",children:p.date_registration})]}),e.jsxs(u.Typography,{variant:"h6",color:"blue-gray",children:["BALANCE OF JULY:"," ",e.jsx("span",{className:"text-orange-900",children:p.latest_balance})]})]}),e.jsxs("div",{children:[e.jsx(u.Button,{onClick:E,variant:"gradient",children:"New Bill"}),e.jsx(u.Dialog,{open:f,handler:E,children:e.jsx(u.DialogBody,{children:e.jsxs(u.Card,{className:"h-[480px] w-full overflow-scroll",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(u.Typography,{variant:"h6",color:"blue-gray",children:"SEARCH CUSTOMER"}),e.jsx("input",{className:"w-96 bg-transparent placeholder:text-slate-400 text-slate-700 text-sm border border-slate-200 rounded-md pl-3 pr-10 py-2 transition duration-300 ease focus:outline-none focus:border-slate-400 hover:border-slate-300 shadow-sm focus:shadow",placeholder:"Search lastname..."})]}),e.jsxs("table",{className:"w-full min-w-max table-auto text-left",children:[e.jsx("thead",{children:e.jsx("tr",{children:y.map(t=>e.jsx("th",{className:"border-b border-blue-gray-100 bg-blue-gray-50 p-4",children:e.jsx(u.Typography,{variant:"small",color:"blue-gray",className:"font-normal leading-none opacity-70",children:t})},t))})}),e.jsx("tbody",{children:I?e.jsx("tr",{children:e.jsx("td",{colSpan:y.length,className:"border border-blue-gray-100 p-4",children:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(u.Spinner,{className:"h-10 w-10",color:"green"})})})}):k.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:x.length,className:"border border-blue-gray-100 p-4 text-center text-red-500",children:e.jsxs("div",{className:"flex justify-center items-center gap-2",children:["No customer records found",e.jsx(CgDanger,{className:"text-xl"})]})})}):k.map(t=>{const{id:i,customer_name:o,status:j,plans:D}=t;return e.jsxs("tr",{className:"hover:bg-blue-gray-50 cursor-pointer",onClick:()=>H(t),children:[e.jsx("td",{className:"border border-blue-gray-100 px-4 py-2 ",children:e.jsx(u.Typography,{variant:"small",className:"font-normal text-gray-800",children:i})}),e.jsx("td",{className:"border border-blue-gray-100 px-4 py-2 ",children:e.jsx(u.Typography,{variant:"small",className:"font-normal text-gray-800",children:o})}),e.jsx("td",{className:"border border-blue-gray-100 px-4 py-2 ",children:e.jsx(u.Typography,{variant:"small",className:"font-normal text-gray-800",children:j})})]},i)})})]})]})})})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-1",children:[e.jsxs("div",{className:"w-full lg:w-[60%] h-[480px] overflow-auto p-4 border-2 border-sky-500",children:[e.jsx(u.Typography,{variant:"h6",color:"blue-gray",children:"ALL TRANSACTION"}),e.jsxs("table",{className:"w-full min-w-max table-auto text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border-b border-blue-gray-100 bg-blue-gray-50 p-4",children:"Month"}),e.jsx("th",{className:"border-b border-blue-gray-100 bg-blue-gray-50 p-4",children:"Bill No"}),e.jsx("th",{className:"border-b border-blue-gray-100 bg-blue-gray-50 p-4",children:"Partial"}),e.jsx("th",{className:"border-b border-blue-gray-100 bg-blue-gray-50 p-4",children:"Total Amount Paid"}),e.jsx("th",{className:"border-b border-blue-gray-100 bg-blue-gray-50 p-4",children:"Remarks"}),e.jsx("th",{className:"border-b border-blue-gray-100 bg-blue-gray-50 p-4",children:"Status"})]})}),e.jsx("tbody",{children:I?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"border p-4",children:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(u.Spinner,{className:"h-10 w-10",color:"green"})})})}):w.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"border p-4 text-center text-red-500",children:"No transaction records found"})}):w.map(t=>t.plans.flatMap(i=>i.transactions.map(o=>e.jsxs("tr",{className:"hover:bg-blue-gray-50",children:[e.jsx("td",{className:"border px-4 py-2",children:new Date(o.created_at).toLocaleDateString("en-US")}),e.jsx("td",{className:"border px-4 py-2",children:o.bill_no}),e.jsx("td",{className:"border px-4 py-2",children:new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(o.partial)}),e.jsx("td",{className:"border px-4 py-2",children:new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(o.bill_amount)}),e.jsx("td",{className:"border px-4 py-2",children:o.remarks}),e.jsx("td",{className:"border px-4 py-2",children:o.status})]},o.id))))})]})]}),e.jsx("div",{className:"w-full lg:w-[35%] p-4 overflow-auto shadow-md rounded-md border-2 border-sky-500",children:e.jsxs("form",{onSubmit:b,children:[e.jsx("input",{type:"hidden",value:a.customer_plan_id,onChange:t=>n("customer_plan_id",t.target.value),className:"mb-2"}),e.jsxs("div",{className:"mb-1",children:[e.jsx(u.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Acc No."}),e.jsx(u.Input,{size:"md",value:a.customer_plan_id,disabled:!0,className:"mb-3"})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(u.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Bill No."}),e.jsx(u.Input,{size:"md",value:a.bill_no,disabled:!0,className:"mb-3"})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(u.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Rebate"}),e.jsx(u.Input,{type:"number",size:"md",value:a.rebate||"",onChange:t=>{const i=Number(t.target.value),o=Number(p.plan_price);i>o?(alert(`Rebate cannot be greater than Plan Price (${o}).`),n("rebate",o)):n("rebate",i)},className:"mb-3",onWheel:t=>t.target.blur()})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(u.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Partial"}),e.jsx(u.Input,{type:"number",size:"md",value:a.partial||"",onChange:t=>{const i=Number(t.target.value),o=Number(p.plan_price);i>o?(alert(`Partial cannot be greater than Plan Price (${o}).`),n("partial",o)):n("partial",i)},className:"mb-3",onWheel:t=>t.target.blur()})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(u.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Total Amount Paid"}),e.jsx(u.Input,{type:"number",size:"md",value:Number(p.plan_price)-Number(a.rebate||0),onChange:t=>n("bill_amount",t.target.value),className:"mb-3",disabled:!0})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(u.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Outstanding Balance"}),e.jsx(u.Input,{size:"md",value:Number(a.partial)===Number(p.plan_price)?0:Math.max(0,Number(p.plan_price)-Number(a.rebate||0)-(Number(a.partial||0)+Number(a.bill_amount||0))),disabled:!0,className:"mb-3"})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(u.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Status"}),e.jsx(me,{options:v,placeholder:"Choose a status",value:v.find(t=>t.value===a.status),onChange:t=>n("status",t?t.value:""),className:"mb-3"})]}),e.jsx(u.Button,{type:"submit",disabled:m,color:"blue",fullWidth:!0,children:"Save"})]})})]})]})]})};export{$e as default};
