import{a as c,b as T,j as e,M as I,r as s,U as M,c as E}from"./app-Bcq0O7gy.js";import{A as z,B as A}from"./AuthenticatedLayout-CF0IW3t9.js";import{S as d}from"./react-select.esm-CCLtK8Ev.js";const L=({customers:u,collectors:p})=>{const[h,b]=c.useState(""),[g,r]=c.useState(""),[x,v]=c.useState(""),[j,y]=c.useState(""),{data:o,setData:t,post:N,errors:n,reset:f,processing:C}=T({customer_id:"",bill_no:"",or_no:"",amount:"",remarks:"",collector_id:""});console.log(h);const _=async a=>{a.preventDefault(),await N(route("bills.store"),{onSuccess:()=>{alert("Bill was added successfully!"),f()},onError:l=>{console.log(l)}})},i=Object.values(u).map(a=>({value:a.customer.id,label:`${a.customer.lastname} ${a.customer.firstname}`})),m=p.map(a=>({value:a.id,label:`${a.lastname} ${a.firstname}`})),w=async a=>{if(console.log("Selected Option: ",a.value),a){t("customer_id",a.value);try{const l=await E.get(`/api/customers/${a.value}/latest-plan`);if(l.data){const{id:S,mbps:$,plan_price:B,registration_date:P}=l.data;b(S),r($),v(B),y(P)}else console.log("No plan found for the selected customer."),r("No Mbps plan available")}catch(l){console.error("Error fetching the plan:",l),r("Error fetching Mbps plan")}}else r("")};return e.jsxs(z,{children:[e.jsx(I,{title:"Add Customer"}),e.jsx("div",{className:"bg-white overflow-y-auto max-h-[590px] grid place-justify-center ",children:e.jsx("div",{className:"mt-2 px-4",children:e.jsx("div",{className:"mb-6 flex justify-between items-center",children:e.jsxs(s.Card,{color:"white",className:" mx-auto w-full max-w-xl  p-8 shadow-md rounded-md mt-1 mb-2",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsx(s.Tooltip,{content:"Back",children:e.jsx(M,{href:"/bills",className:"hover:bg-gray-200 px-2 py-1 rounded",children:e.jsx(A,{className:"text-xl cursor-pointer"})})})}),e.jsx(s.Typography,{variant:"h5",color:"blue-gray",className:"text-center",children:"New Bill"}),e.jsxs("form",{onSubmit:_,className:"mt-8 mb-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Bill No."}),e.jsx(s.Input,{size:"md",value:o.bill_no,onChange:a=>t("bill_no",a.target.value),error:!!n.bill_no,className:"w-full"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Or No."}),e.jsx(s.Input,{size:"md",value:o.or_no,onChange:a=>t("or_no",a.target.value),error:!!n.or_no})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Customers"}),e.jsx(d,{options:i,placeholder:"Choose a customer",isSearchable:!0,value:i.find(a=>a.value===o.customer_id),onChange:w,className:`${n.customer_id?"border border-red-600":""}`})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Mbps Plan"}),e.jsx(s.Input,{disabled:!0,size:"md",value:`${g} mbps - â‚±${new Intl.NumberFormat("en-PH").format(x)}`,onChange:a=>r(a.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Date Registration"}),e.jsx(s.Input,{disabled:!0,type:"date",size:"md",value:j,onChange:a=>r(a.target.value)})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Amount"}),e.jsx(s.Input,{type:"number",size:"md",value:o.amount,onChange:a=>t("amount",a.target.value),error:!!n.amount})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Collectors"}),e.jsx(d,{options:m,placeholder:"Choose a collector",isClearable:!0,value:m.find(a=>a.value===o.collector_id),onChange:a=>t("collector_id",a?a.value:""),className:`${n.collector_id?"border border-red-600":""}`})]}),e.jsx(s.Button,{type:"submit",disabled:C,className:"mt-6 w-full",color:"blue",fullWidth:!0,children:"Save"})]})]})})})})]})};export{L as default};
