import{a as s,j as e,M as f,r as _,c as w}from"./app-C0av7KRX.js";import{A as S}from"./AuthenticatedLayout-BA0m_5f3.js";import{l as D}from"./index-ClVF3nuS.js";import{U as A}from"./UseAppUrl-CFGEf5wJ.js";import"./NavLink-DnJTj9BQ.js";import"./index-DQgZOy05.js";const I=()=>{var p;const m=A(),[a,t]=s.useState(null),[l,b]=s.useState(""),[n,h]=s.useState(""),[o,u]=s.useState(new Date().getFullYear()),[d,c]=s.useState(!1),i=s.useRef(),y=D.useReactToPrint({contentRef:i}),x=async()=>{if(l){c(!0);try{const r=await w.get(`${m}/api/customer_soa`,{params:{search:l,month:n,year:o}});console.log(r.data),t(r.data.customer)}catch(r){console.error("Error fetching SOA:",r),t(null)}finally{c(!1)}}},g=r=>{r.key==="Enter"&&(r.preventDefault(),x())},j=[{value:"",label:"All Months"},{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],N=Array.from({length:5},(r,v)=>new Date().getFullYear()-v);return e.jsxs(S,{children:[e.jsx(f,{title:"Customer Soa"}),e.jsxs("div",{className:"max-w-4xl mx-auto mt-6 mb-4 flex flex-wrap gap-2 items-center",children:[e.jsx("input",{type:"text",placeholder:"Enter Firstname / Lastname...",value:l,onChange:r=>b(r.target.value),onKeyDown:g,className:"border border-gray-400 rounded-md px-3 py-2 w-[280px]"}),e.jsx("select",{value:n,onChange:r=>h(r.target.value),className:"border border-gray-400 rounded-md px-3 py-2",children:j.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))}),e.jsx("select",{value:o,onChange:r=>u(r.target.value),className:"border border-gray-400 rounded-md px-3 py-2",children:N.map(r=>e.jsx("option",{value:r,children:r},r))}),e.jsx("button",{onClick:x,className:"bg-blue-600 hover:bg-sky-700 text-white px-4 py-2 rounded-md",children:"Search"}),e.jsx(_.Button,{variant:"gradient",className:"w-[180px]",color:"green",onClick:()=>y(),children:"Print"})]}),d&&e.jsx("div",{className:"p-8 text-center text-gray-600",children:"Loading..."}),!d&&a===null&&l&&e.jsxs("div",{className:"p-8 text-center text-red-500",children:["No data found for: ",l]}),a&&e.jsx("div",{className:"overflow-y-auto max-h-[590px]  bg-white text-black max-w-4xl mx-auto border border-gray-400 shadow-md",children:e.jsxs("div",{ref:i,className:"p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"font-bold text-lg",children:"CFS INTERNET NETWORK SOLUTION"}),e.jsxs("p",{className:"text-sm",children:["#2, Managuelod Bldg. National High Way ",e.jsx("br",{}),"District II, Tumauini, Isabela."]}),e.jsx("p",{className:"text-sm",children:"TIN: 295-973-965-001    CP#: 09453367030"})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Printed Date:"})," ",e.jsx("span",{children:new Date().toLocaleDateString()})]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Account No.:"})," ",e.jsx("span",{children:a.id})]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Client Name:"})," ",e.jsx("span",{children:`${a.firstname} ${a.lastname}`})]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Contact No:"})," ",e.jsx("span",{children:a.contact_no})]})]}),a.customer_plans.length>0&&e.jsxs("table",{className:"w-full border-collapse border border-gray-400 text-sm mb-8",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-400 px-2 py-1",children:"Date of Registration"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1",children:"Day of Billing"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1",children:"MBPS"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1",children:"Plan Price"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1 h-8",children:a.customer_plans[0].date_registration}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.customer_plans[0].date_billing}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:a.customer_plans[0].plan.mbps}),e.jsxs("td",{className:"border border-gray-400 px-2 py-1",children:["₱",a.customer_plans[0].plan.plan_price]})]})})]}),e.jsx("h3",{className:"text-center font-bold mb-2",children:"STATEMENT OF ACCOUNT"}),e.jsxs("table",{className:"w-full border-collapse border border-gray-400 text-sm mb-12",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-400 px-2 py-1",children:"Bill No."}),e.jsx("th",{className:"border border-gray-400 px-2 py-1",children:"Month/Year"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1",children:"Billing Date"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1",children:"Plan Price"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1",children:"Payment"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1",children:"Outstanding Balance"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1",children:"Remarks"})]})}),e.jsx("tbody",{children:(p=a.customer_plans[0])==null?void 0:p.transactions.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:r.bill_no}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:new Date(r.date_billing).toLocaleString("default",{month:"long",year:"numeric"})}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:r.date_billing}),e.jsxs("td",{className:"border border-gray-400 px-2 py-1",children:["₱",r.plan_price]}),e.jsxs("td",{className:"border border-gray-400 px-2 py-1",children:["₱",r.bill_amount]}),e.jsxs("td",{className:"border border-gray-400 px-2 py-1",children:["₱",r.outstanding_balance]}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:r.remarks})]},r.id))})]})]})})]})};export{I as default};
