import{a as n,b as S,j as e,M as B,r as s,U as M,c as $}from"./app-Di-P1_Lg.js";import{A as I,B as T}from"./AuthenticatedLayout-BiwEwxic.js";import{S as E}from"./react-select.esm-DGsMVsQw.js";const U=({customers:h,collectors:D,generated_bill_no:i})=>{const[z,b]=n.useState(""),[g,l]=n.useState(""),[x,v]=n.useState(""),[j,y]=n.useState(""),{data:r,setData:o,post:N,errors:c,reset:f,processing:_}=S({customer_plan_id:"",bill_no:i,bill_amount:""}),w=async a=>{a.preventDefault(),console.log(r),await N(route("batch_bills.store"),{onSuccess:()=>{alert("Batch Bill was created successfully!"),f()},onError:t=>{console.log(t)}})},d=h.map(a=>({value:a.id,label:`${a.lastname} ${a.firstname}`})),C=async a=>{if(console.log("Selected Option: ",a.value),a){o("customer_id",a.value);try{const t=await $.get(`/api/customers/${a.value}/latest-plan`);if(t.data){const{id:m,mbps:u,plan_price:p,registration_date:P}=t.data;console.log("Latest Plan Mbps: ",u),console.log("Plan Price: ",p),o("customer_plan_id",m),b(m),l(u),v(p),y(P)}else console.log("No plan found for the selected customer."),l("No Mbps plan available")}catch(t){console.error("Error fetching the plan:",t),l("Error fetching Mbps plan")}}else l("")};return console.log("trish"+i),e.jsxs(I,{children:[e.jsx(B,{title:"Create New Bill"}),e.jsx("div",{className:"bg-white overflow-y-auto max-h-[590px] grid place-justify-center ",children:e.jsx("div",{className:"mt-2 px-4",children:e.jsx("div",{className:"mb-6 flex justify-between items-center",children:e.jsxs(s.Card,{color:"white",className:" mx-auto w-full max-w-xl  p-8 shadow-md rounded-md mt-1 mb-2",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsx(s.Tooltip,{content:"Back",children:e.jsx(M,{href:"/batch_bills",className:"hover:bg-gray-200 px-2 py-1 rounded",children:e.jsx(T,{className:"text-xl cursor-pointer"})})})}),e.jsx(s.Typography,{variant:"h5",color:"blue-gray",className:"text-center",children:"New Bill"}),e.jsxs("form",{onSubmit:w,className:"mt-8 mb-2",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Bill No."}),e.jsx("input",{type:"hidden",value:r.customer_plan_id,onChange:a=>o("customer_plan_id",a.target.value)}),e.jsx("input",{type:"hidden",value:r.bill_no,onChange:a=>o("bill_no",a.target.value)}),e.jsx(s.Input,{size:"md",value:r.bill_no,disabled:!0})]})}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Customers"}),e.jsx(E,{options:d,placeholder:"Choose a customer",isSearchable:!0,value:d.find(a=>a.value===r.customer_id),onChange:C,className:`${c.customer_id?"border border-red-600":""}`})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Mbps Plan"}),e.jsx(s.Input,{disabled:!0,size:"md",value:`${g} mbps - â‚±${new Intl.NumberFormat("en-PH").format(x)}`,onChange:a=>l(a.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Date Registration"}),e.jsx(s.Input,{disabled:!0,type:"date",size:"md",value:j,onChange:a=>l(a.target.value)})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(s.Typography,{variant:"paragraph",color:"blue-gray",className:"mb-1 ",children:"Amount"}),e.jsx(s.Input,{type:"number",size:"md",value:r.bill_amount,onChange:a=>o("bill_amount",a.target.value),error:!!c.bill_amount})]}),e.jsx(s.Button,{type:"submit",disabled:_,className:"mt-6 w-full",color:"blue",fullWidth:!0,children:"Save"})]})]})})})})]})};export{U as default};
